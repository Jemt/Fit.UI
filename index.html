<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="stylesheet" type="text/css" href="Fit.UI.css">
	<script type="text/javascript" src="Fit.UI.js"></script>
	<title>Welcome</title>

	<style type="text/css">
		body
		{
			font-family: verdana;
			font-size: 14px;
		}

		span.xxx[data-title="hej"]
		{
			background: red;
		}
	</style>

	<script type="text/javascript">
		// Prevent JS errors in legacy IE
		if (!window.console)
			window.console = {};
		if (!window.console.log)
			window.console.log = function() {};
	</script>
</head>
<body>
<form action="index.html" method="POST">

<div id="draggable1" style="border: 2px solid black; background-color: orange; width: 100px; height: 100px;">
	Hello world, I am draggable!
</div>

<br><br>

<div id="dropzone1" style="border: 2px solid black; background-color: green; width: 200px; height: 200px;">
	Hello world, I am a dropzone (while also being draggable - cool, huh?)
</div>

<br><br>

<b>Editor</b>

<br><br>

<ul>
	<li>Single line input</li>
	<li>Multi line input</li>
	<li>WYSIWYG/Rich/HTML/RTF Editor</li>
	<li>Maximizable</li>
	<li>Truely dirty aware</li>
	<li>API</li>
</ul>

<br><br>

<input type="button" value="Toggle: MultiLine" onclick="Fit.Controls.Find('MyInput').MultiLine(!Fit.Controls.Find('MyInput').MultiLine());">
<input type="button" value="Set Height (px)" onclick="Fit.Controls.Find('MyInput').Height(parseInt(prompt('Indtast højde i pixels', 100)));">
<input type="button" value="Set Height (em)" onclick="Fit.Controls.Find('MyInput').Height(parseInt(prompt('Indtast højde i em unit', 3)), 'em');">
<input type="button" value="Set Width (px)" onclick="Fit.Controls.Find('MyInput').Width(parseInt(prompt('Indtast bredde i pixels', 500)));">
<input type="button" value="Toggle: Maximizable" onclick="Fit.Controls.Find('MyInput').Maximizable(!Fit.Controls.Find('MyInput').Maximizable());">
<input type="button" value="Toggle: Design Mode" onclick="Fit.Controls.Find('MyInput').DesignMode(!Fit.Controls.Find('MyInput').DesignMode());">
<input type="button" value="Make Draggable" onclick="new Fit.DragDrop.Draggable(Fit.Controls.Find('MyInput').GetDomElement());">
<input type="button" value="IsDirty" onclick="alert('Is dirty (different from initial value): ' + Fit.Controls.Find('MyInput').IsDirty())">
<input type="button" value="GetValue" onclick="alert('Value: ' + Fit.Controls.Find('MyInput').Value())">
<input type="button" value="SetValue" onclick="Fit.Controls.Find('MyInput').Value(prompt('Indtast værdi', 'Hello world'));">
<input type="button" value="Enable A-Z 0-9 RegExp" onclick="Fit.Controls.Find('MyInput').SetValidationExpression(new RegExp('^[a-z0-9 ]*$', 'i'), 'Only A-Z, 0-9 and space is allowed!');">
<input type="button" value="Focus" onclick="setTimeout(function() { Fit.Controls.Find('MyInput').Focused(true); }, 300);">
<input type="submit" value="Submit page">

<br><br>

<div id="Input"></div>

<a name="SectionTreeView"></a>
<br><br><br>

<b>TreeView</b>

<br><br>

<ul>
	<li>Implemented:
		<ul>
			<li>Performance: Indexed node lookup, Utilizing event propagation for reduced amount of event handlers</li>
			<li>Strong CSS interface</li>
			<li>Helper lines supported</li>
			<li>Truely dirty aware</li>
			<li>HTML compatible (nodes may contain rich content; HTML/CSS/JS)</li>
			<li>Selection modes: Single / Multi / None (e.g. for navigation)</li>
			<li>Part of standard control flow (gains focus)</li>
			<li>Navigation nodes supported through standard HTMLLink object</li>
			<li>AllowNull = False (Required on BaseClass)</li>
			<li>Word wrap support</li>
			<li>Full keyboard navigation:
				<ul>
					<li>Arrow down/up = select down/up</li>
					<li>Tab/Shift+Tab = select down/up</li>
					<li>arrow left/right = collapse/expand (also possible using Double-Click on nodes)</li>
					<li>arrow left on non-expandable node = jump to parent</li>
					<li>Spacebar = select/deselect</li>
					<li>Enter = Open navigation node (URL)</li>
				</ul>
			</li>
			<li>API and Event model (OnSelect, OnSelecting, OnToggle, OnToggling, OnChange)</li>
		</ul>
	</li>
	<li>TODO:
		<ul>
			<li>Select All checkboxes</li>
			<li>WebService support (consume Fit.UI standard data structures through WebService)</li>
		</ul>
	</li>
</ul>


Fit.Array.ForEach(document.querySelectorAll("li"), function(l) { new Fit.DragDrop.Draggable(l); });

<br><br>

<input type="button" value="Show dotted lines" onclick="window.ShowLines(true);">
<input type="button" value="Show solid lines" onclick="window.ShowLines(true); var t = Fit.Controls.Find('MyTreeView'); t.RemoveCssClass('FitUiControlTreeViewDotLines'); ">
<input type="button" value="Hide lines" onclick="window.ShowLines(false);">
<input type="button" value="Single-selections" onclick="var t = Fit.Controls.Find('MyTreeView'); t.Selectable(true);">
<input type="button" value="Single-selections with checkboxes" onclick="var t = Fit.Controls.Find('MyTreeView'); t.Selectable(true); Fit.Array.ForEach(t.GetAllNodes(), function(n) { n.Selectable(true, true, false); });">
<input type="button" value="Multi-selections" onclick="var t = Fit.Controls.Find('MyTreeView'); t.Selectable(true, true);">
<input type="button" value="Disable selections" onclick="var t = Fit.Controls.Find('MyTreeView'); t.Selectable(false);">
<input type="button" value="Get value" onclick="var t = Fit.Controls.Find('MyTreeView'); var s = t.Selected(); var v = 'Selected:\n'; Fit.Array.ForEach(s, function(n) { v += '\n -- ' + n.Title() }); alert(v);">
<input type="button" value="Clear" onclick="Fit.Controls.Find('MyTreeView').Clear()">
<input type="button" value="Clear but keep pre-selections" onclick="Fit.Controls.Find('MyTreeView').Clear(true)">
<input type="button" value="Focus" onclick="setTimeout(function() { Fit.Controls.Find('MyTreeView').Focused(true); }, 300);">
<input type="button" value="Toggle word wrap" onclick="Fit.Controls.Find('MyTreeView').WordWrap(!Fit.Controls.Find('MyTreeView').WordWrap());">
<br><br>

<div id="TreeView" style="font-size: 12px; color: #3D9CCF; padding-left: 100px; float: left;"></div>
<div style="float: left; padding: 150px; border: 2px solid orange; background-color: #E3EFF9;" ondblclick="Fit.DragDrop.Draggable(this);">
	Content area - tree is not allowed to overflow this area! Word wrap!
</div>
<div style="clear:both"></div>

<br><br>
<br><br><br><br>



<script type="text/javascript">
	window.ShowLines = function(val)
	{
		var tree = Fit.Controls.Find('MyTreeView');
		tree.Lines(val);
	}

	Fit.Events.OnReady(function()
	{
		new Fit.DragDrop.Draggable(document.getElementById("draggable1"));
		new Fit.DragDrop.Dropzone(document.getElementById("dropzone1"));
		new Fit.DragDrop.Draggable(document.getElementById("dropzone1"));

		var input = new Fit.Controls.Input("MyInput");
		input.IsValid();
		//input.Render(document.body);
		input.Render(document.getElementById("Input"));
		input.OnChange(function(sender, value) { console.log(sender, value); });
		input.Width(300);
		input.Value("Hello world");
		input.Focused(true);
		//input.SetMaximizable(true, 100, 300, "px");
		//input.SetMaximizable(true, 300, 900, "px");
		//input.Height(40);
		//input.EnableMaximize(200);

		//new Fit.DragDrop.Draggable(input.GetDomElement());


		// TREE

		var tree = new Fit.Controls.TreeView("MyTreeView");
		tree.Selectable(true, true, true);
		tree.Required(true);
		tree.Scope("MyScope");
		tree.WordWrap(true);
		tree.Lines(true);

		var ctxNode = null;
		var ctx = new Fit.Controls.WSContextMenu();
		ctx.Url("getdata.php");
		ctx.OnShowing(function(sender) { console.log("ContextMenu.Showing", sender, sender.GetDomElement()); });
		ctx.OnShown(function(sender) { console.log("ContextMenu.Shown", sender, sender.GetDomElement()); });
		ctx.OnSelect(function(sender, item) { console.log("ContextMenu.Select", item.Title(), item.Value(), sender.GetChild(item.Value(), true)); });
		tree.ContextMenu(ctx);

		tree.OnContextMenu(function(sender, node)
		{
			ctxNode = node;
			console.log("TreeView.OnContextMenu", sender, sender.GetDomElement());
		});
		ctx.OnRequest(function(sender, eventArgs)
		{
			eventArgs.Request.AddData("Search", ctxNode.Title());
			ctxNode = null;
		});

		tree.OnChange(function(sender, value)
		{
			var vals = "";

			Fit.Array.ForEach(sender.Selected(), function(node)
			{
				vals += (vals !== "" ? ", " : "") + node.Title();
			});

			console.log("OnChange: " + vals);
			//console.log("OnChange - IsDirty: " + sender.IsDirty());
		});
		tree.OnSelect(function(sender, value)
		{
			console.log("OnSelect", value.Title() + " (" + value.Value() + ") [" + value.Selected() + "]");

			if (value.Value() === "001")
			{
				console.log(" -- Canceling!");
				return false;
			}
		});
		tree.OnSelected(function(sender, value)
		{
			console.log("OnSelected", value.Title() + " (" + value.Value() + ") [" + value.Selected() + "]");
		});
		tree.OnToggle(function(sender, value)
		{
			console.log("OnToggle", value.Title() + " (" + value.Value() + ") [" + value.Selected() + "]");

			if (value.Value() === "005")
			{
				console.log(" -- Canceling!");
				return false;
			}
		});
		tree.OnToggled(function(sender, value)
		{
			console.log("OnToggled", value.Title() + " (" + value.Value() + ") [" + value.Selected() + "]");
		});

		var n1 = new Fit.Controls.TreeView.Node("<i>Salg & administration (disabled)</i>", "001");
		n1.AddChild(new Fit.Controls.TreeView.Node("Karsten", "001-1"));
		n1.AddChild(new Fit.Controls.TreeView.Node("Andreas", "001-2"));
		n1.AddChild(new Fit.Controls.TreeView.Node("Eva", "001-3"));
		n1.AddChild(new Fit.Controls.TreeView.Node("Hanne", "001-4"));
		n1.AddChild(new Fit.Controls.TreeView.Node("Anne", "001-5"));
		n1.AddChild(new Fit.Controls.TreeView.Node("Telemarketing", "001-10"));

		var n2 = new Fit.Controls.TreeView.Node("Markedsføring", "002");
		n2.AddChild(new Fit.Controls.TreeView.Node("Jens", "002-1"));
		n2.AddChild(new Fit.Controls.TreeView.Node("Louise", "002-2"));
		n2.AddChild(new Fit.Controls.TreeView.Node("Jimmy (non-selectable, preselected)", "002-3"));

		n2.Selected(true);
		n2.Expanded(true);
		n2.GetChildren()[0].Selected(true);
		n2.GetChildren()[2].Selected(true);
		n2.GetChildren()[2].Selectable(false);
		n2.GetChildren()[2].Selected(true);
		n2.GetChildren()[2].AddChild(new Fit.Controls.TreeView.Node("Node uden checkbox", "4957889"));
		n2.GetChildren()[2].AddChild(new Fit.Controls.TreeView.Node("Non-selectable node, unselected", "97626"));
		n2.GetChildren()[2].GetChildren()[0].Selectable(false, false, false);
		n2.GetChildren()[2].GetChildren()[0].Selected(true);
		n2.GetChildren()[2].GetChildren()[1].Selectable(false);


		var n3 = new Fit.Controls.TreeView.Node("Produktudvikling", "003");
		n3.AddChild(new Fit.Controls.TreeView.Node("Lars", "003-1"));
		n3.AddChild(new Fit.Controls.TreeView.Node("Hans", "003-2"));
		n3.AddChild(new Fit.Controls.TreeView.Node("Jimmy", "003-3"));
		n3.AddChild(new Fit.Controls.TreeView.Node("Michael", "003-4"));
		n3.AddChild(new Fit.Controls.TreeView.Node("Ilda", "003-5"));
		n3.AddChild(new Fit.Controls.TreeView.Node("Ole", "003-6"));

		n3.Selected(true);

		var n4 = new Fit.Controls.TreeView.Node("Deployment & Support", "004");
		n4.AddChild(new Fit.Controls.TreeView.Node("Martin", "004-1"));
		n4.AddChild(new Fit.Controls.TreeView.Node("John", "004-2"));
		n4.AddChild(new Fit.Controls.TreeView.Node("Jacob", "004-3"));
		n4.AddChild(new Fit.Controls.TreeView.Node("Anders", "004-4"));
		n4.AddChild(new Fit.Controls.TreeView.Node("Jan", "004-5"));
		n4.AddChild(new Fit.Controls.TreeView.Node("Thomas", "004-6"));
		//n4.AddChild(new Fit.Controls.TreeView.Node("<span onclick=\"location.href='http://flowit.dk'\">Navigate to FlowIT.dk</span>", "004-7"));
		n4.AddChild(new Fit.Controls.TreeView.Node("<a href=\"http://flowit.dk\">Navigate to FlowIT.dk</a>", "004-7"));
		var n4b = new Fit.Controls.TreeView.Node("IT Administration", "004b");
		n4b.AddChild(new Fit.Controls.TreeView.Node("Christian", "004b-1"));
		n4b.AddChild(new Fit.Controls.TreeView.Node("John", "004b-2"));
		n4.AddChild(n4b);
		var fcd = new Fit.Controls.TreeView.Node("Final count down", "004-6123");
		fcd.AddChild(new Fit.Controls.TreeView.Node("ABC", "00864-12345"));
		fcd.AddChild(new Fit.Controls.TreeView.Node("DEF", "00864-123456"));
		n4.AddChild(fcd);
		var n4b2 = new Fit.Controls.TreeView.Node("IT Support", "004b2");
		n4b2.AddChild(new Fit.Controls.TreeView.Node("Hovednummer", "004b2-1"));
		n4b2.AddChild(new Fit.Controls.TreeView.Node("Christian", "004b2-2"));
		n4b.AddChild(n4b2);
		//n4.AddChild(new Fit.Controls.TreeView.Node("Place holder A", "004-7"));
		//n4.AddChild(new Fit.Controls.TreeView.Node("Place holder B", "004-8"));

		var n5 = new Fit.Controls.TreeView.Node("Solution Center (expand/collapse canceled)", "005");
		n5.AddChild(new Fit.Controls.TreeView.Node("Ida", "005-1"));

		tree.AddChild(n1);
		tree.AddChild(n2);
		tree.AddChild(n3);
		tree.AddChild(n4);
		tree.AddChild(n5);

		//document.body.innerHTML = "";
		//document.body.appendChild(tree.GetDomElement());
		//document.getElementById("TreeView").appendChild(tree.GetDomElement());
		tree.Render(document.getElementById("TreeView"));



		setTimeout(function()
		{
			Fit.Controls.Find("MyTreeView").Clear();
		}, 750);
		setTimeout(function()
		{
			Fit.Controls.Find("MyTreeView").Selected([Fit.Controls.Find("MyTreeView").GetChild("004", true), Fit.Controls.Find("MyTreeView").GetChild("005", true)]);
		}, 1000);
		setTimeout(function()
		{
			var ds = Fit.Controls.Find("MyTreeView").GetChild("004", true);
			ds.Expanded(true);
		}, 1500);
		setTimeout(function()
		{
			Fit.Controls.Find("MyTreeView").GetChild("001-4", true).Selected(false);
			Fit.Controls.Find("MyTreeView").GetChild("001-4", true).Selected(false);
			Fit.Controls.Find("MyTreeView").GetChild("001-4", true).Selected(true);

			Fit.Controls.Find("MyTreeView").GetChild("004-6123", true).Selected(true);
			Fit.Controls.Find("MyTreeView").GetChild("004-6123", true).GetChildren()[0].Selected(true);

			Fit.Controls.Find("MyTreeView").GetChild("002-3", true).Selected(true); // Select non-selectable node

			// Remove checkboxes while still allowing selections
			Fit.Controls.Find("MyTreeView").GetChild("004-4", true).Selectable(true, false);
			Fit.Controls.Find("MyTreeView").GetChild("004-5", true).Selectable(true, false);
			Fit.Controls.Find("MyTreeView").GetChild("004-6", true).Selectable(true, false);

			var ds = Fit.Controls.Find("MyTreeView").GetChild("004", true);
			ds.GetChildren()[0].Selected(true);
			ds.GetChildren()[3].Selected(true);
		}, 2000);
		setTimeout(function() { Fit.Controls.Find("MyTreeView").Focused(false); }, 2200);
		setTimeout(function() { Fit.Controls.Find("MyTreeView").Focused(true); }, 2400);
		setTimeout(function() { Fit.Controls.Find("MyTreeView").Focused(false); }, 2600);
		setTimeout(function() { Fit.Controls.Find("MyTreeView").Focused(true); }, 2800);
		setTimeout(function() { Fit.Controls.Find("MyTreeView").Focused(false); }, 3000);

		setTimeout(function() { var n = Fit.Controls.Find("MyTreeView").GetChild("004-6123", true); n.Expanded(true); setTimeout(function() { n.GetParent().RemoveChild(n); }, 1000); }, 3200);

		//setTimeout(function() { Fit.Array.ForEach(Fit.Controls.Find("MyTreeView").GetAllNodes(), function(n) { n.Selectable((n.Title().toLowerCase().indexOf("non-selectable") === -1), true); }); }, 3500);

		//n1.GetChild("1798234").Dispose()


	});
</script>


<br><br>

In-place render:<br>

<script type="text/javascript">
		var input = new Fit.Controls.Input("MyRenderInPlaceInput");
		input.Width(300);
		input.Value("Hello world!");
		input.Render();
</script>

<br>Two more:<br>

<script type="text/javascript">
		var input = new Fit.Controls.Input("MyRenderInPlaceInput2");
		input.Width(300);
		input.Value("Hello 1");
		input.Render();

		var input = new Fit.Controls.Input("MyRenderInPlaceInput3");
		input.Width(300);
		input.Value("Hello 2");
		input.Render();
</script>

<br>In-place render DONE!<br>

<br><br>

	req = new Fit.Http.Request("http://domain.com/post.php");<br>
	req.AddData("Name", "Jimmy");<br>
	req.AddData("Age", "31");<br>
	req.AddData("Gender", "Male");<br>
	req.SetStateListener(function(r) { console.log("State listener", r, r.GetCurrentState(), r.GetHttpStatus()); });<br>
	req.OnStateChange(function(r) { console.log("OnStateChange ", r, r.GetCurrentState(), r.GetHttpStatus()); });<br>
	req.OnSuccess(function(r) { console.log("OnSuccess ", r, r.GetResponseText()); });<br>
	req.OnSuccess(function(r) { console.log("Finally done!"); });<br>
	req.OnFailure(function(r) { console.log("OnFailure ", r, r.GetHttpStatus()); });<br>
	req.Start();<br>

<br><br><br><br>


<h1>WS TreeView</h1>

<br><br>

<input type="button" value="Lines" onclick="Fit.Controls.Find('MyWSTreeView').Lines(!Fit.Controls.Find('MyWSTreeView').Lines());">
<input type="button" value="Focus" onclick="setTimeout(function() { Fit.Controls.Find('MyWSTreeView').Focused(true); }, 300);">
<input type="button" value="Word wrap" onclick="Fit.Controls.Find('MyWSTreeView').WordWrap(!Fit.Controls.Find('MyWSTreeView').WordWrap());">
<input type="button" value="Selectable" onclick="Fit.Controls.Find('MyWSTreeView').Selectable(!Fit.Controls.Find('MyWSTreeView').Selectable());">
<input type="button" value="Single" onclick="Fit.Controls.Find('MyWSTreeView').Selectable(Fit.Controls.Find('MyWSTreeView').Selectable(), false);">
<input type="button" value="Multiple" onclick="Fit.Controls.Find('MyWSTreeView').Selectable(Fit.Controls.Find('MyWSTreeView').Selectable(), true);">
<input type="button" value="Battle test" onclick="if (confirm('Auto-load data from 500 nodes (a total of 7000 nodes will be loaded)') === true) { Fit.Controls.Find('MyWSTreeView').BattleTest = true;Fit.Controls.Find('MyWSTreeView').Reload(); }">

<br><br>

<script>
	var nodes = [];
	var requests = 0;
	var start = null;

	var t = new Fit.Controls.WSTreeView("MyWSTreeView");
	//t.Value("1;2"); // Preselections, not loaded yet
	t.Selected([ new Fit.Controls.TreeView.Node("-", "1"), new Fit.Controls.TreeView.Node("-", "2"), new Fit.Controls.TreeView.Node("-", "3") ]);
	t.Url("getdata.php");
	t.Lines(true);
	t.Selectable(true, true, true);
	t.Width(500);

	/*t.OnChange(function(sender, value)
	{
		console.log("OnChange - value: " + value);
	});*/

	t.OnRequest(function(sender, eventArgs)
	{
		var node = eventArgs.Node;
		eventArgs.Request.AddData("NodeLevel", (node !== null ? node.GetLevel()+1 : 0).toString());
		eventArgs.Request.AddData("ParentNode", (node !== null ? node.Value() : ""));
		return;

		var node = eventArgs.Node;
		//var requestContext = eventArgs.Context;

		console.log("OnRequest fired (" + (node !== null ? node.Title() : "null") + ")", sender, node);

		if (node !== null && node.Title() === "Test: OnRequest canceled")
		{
			console.log(" -- Request canceled !");
			return false;
		}

		if (node !== null && node.GetLevel() >= 3 && sender.BattleTest === true)
		{
			//sender.BattleTest = false;
			return false;
		}

		if (start === null && sender.BattleTest === true)
		{
			start = new Date().getTime();
		}

		requests++;

		if (node !== null)
			nodes.push(node);

		if (node !== null && node.Title().indexOf("Child 2 (HasChildren)") !== -1)
		{
			eventArgs.Request.AddData("DynamicNodeTitle", "Node title came from RequestContext");
			//requestContext.DynamicNodeTitle = "Node title came from RequestContext";
		}

		eventArgs.Request.AddData("NodeLevel", (node !== null ? node.GetLevel()+1 : 0).toString());
		eventArgs.Request.AddData("ParentNode", (node !== null ? node.Value() : ""));
		//requestContext.NodeLevel = (node !== null ? node.GetLevel()+1 : 0);
	});

	t.OnPopulated(function(sender, eventArgs)
	{
		return;

		var node = eventArgs.Node;
		var requestContext = eventArgs.Context;

		//nodeCount++;
		//console.log("Node loaded from WS: " + (node !== null ? node.Title() : "Root Node") );

		if (sender.BattleTest)
		{
			var children = (node === null ? sender.GetChildren() : node.GetChildren());

			//setTimeout(function()
			//{
			Fit.Array.ForEach(children, function(c)
			{
				c.Expanded(true)
			});
			//}, 10);
		}
	});

	t.OnToggle(function(sender, n)
	{
		return;
		console.log("OnToggle", n);
	});

	t.OnToggled(function(sender, n)
	{
		return;

		Fit.Array.Remove(nodes, n);

		if (nodes.length === 0)
		{
			var seconds = (new Date().getTime() - start) / 1000;
			console.log("Done - nodes loaded: " + sender.GetAllNodes().length + " over " + requests + " WS requests, " + seconds + " seconds");
		}

		//window.to = setTimeout(function()
		//{
			var seconds = (new Date().getTime() - start) / 1000;
			console.log("Done - nodes loaded: " + sender.GetAllNodes().length + " over " + requests + " WS requests, " + seconds + " seconds");
		//}, 1000);

		/*nodeCount--;

		if (sender.BattleTest === true && nodesExpanded === 5)
		{
			sender.BattleTest = false;
			alert("Done, nodes loaded: " + sender.GetAllNodes().length + " on " + nodesRequested + " requests");

			nodesExpanded = 0;
			nodesRequested = 0;
		}*/
	})

	t.Render();
	Fit.Dom.Attribute(t.GetDomElement(), "style", "font-size: 12px;");


	var inp = new Fit.Controls.Input("MyTreeViewInput");
	inp.GetDomElement().firstChild.onkeydown = function(e)
	{
		var ev = Fit.Events.GetEvent(e);
		Fit.Controls.Find("MyWSTreeView").HandleEvent(ev);
	}
	inp.GetDomElement().firstChild.onfocus = function(e)
	{
		Fit.Controls.Find("MyWSTreeView").SetEventDispatcher(this);
	}
	Fit.Dom.InsertBefore(t.GetDomElement(), inp.GetDomElement());
	Fit.Dom.InsertAfter(inp.GetDomElement(), document.createElement("br"));

	var inp2 = new Fit.Controls.Input("MyTreeViewInput2");
	inp2.GetDomElement().firstChild.onkeydown = function(e)
	{
		var ev = Fit.Events.GetEvent(e);
		Fit.Controls.Find("MyWSTreeView").HandleEvent(ev);
	}
	inp2.GetDomElement().firstChild.onfocus = function(e)
	{
		Fit.Controls.Find("MyWSTreeView").SetEventDispatcher(this);
	}
	Fit.Dom.InsertBefore(t.GetDomElement(), inp2.GetDomElement());
	Fit.Dom.InsertAfter(inp2.GetDomElement(), document.createElement("br"));

	t.MaxHeight(300, "px");
	t.Width(600, "px");
	t.OnItemSelectionChanged(function(title, value, selected) { return; console.log("OnItemSelectionChanged", title, value, selected); });
</script>

<br><br><br><br><br><br><br> Yiihaaaa ! <br><br><br>

<script type="text/javascript">

var inp = new Fit.Controls.Input("MyListViewInput");
inp.GetDomElement().firstChild.onkeydown = function(e)
{
	var ev = Fit.Events.GetEvent(e);

	Fit.Controls.Find("MyListView").HandleEvent(ev);
}
inp.GetDomElement().firstChild.onfocus = function(e)
{
	Fit.Controls.Find("MyListView").SetEventDispatcher(this);
}
inp.Render();

var lv = new Fit.Controls.ListView("MyListView");
lv.AddItem("Hapsen", Math.random().toString());
lv.AddItem("Bedutten", Math.random().toString());
lv.AddItem("Skrutten", Math.random().toString());
lv.AddItem("Prutten", Math.random().toString());
lv.AddItem("Sutten", Math.random().toString());
lv.AddItem("Krudten", Math.random().toString());
lv.AddItem("Futten", Math.random().toString());
lv.AddItem("Mutten", Math.random().toString());
lv.AddItem("Lutten", Math.random().toString());
lv.AddItem("<b>Nutten</b> <span style='color:red'><3</span>", Math.random().toString());
lv.AddItem("<i>Natten</i>", Math.random().toString());
lv.AddItem("Katten", Math.random().toString());
lv.MaxHeight(100, "px");
lv.OnItemSelectionChanged(function(title, value, selected) { console.log(title, value, selected); });
Fit.Dom.InsertBefore(inp.GetDomElement(), lv.GetDomElement());


</script>

<br><br>

<h1>Drop down with WSTreeView</h1>

<br><br>

<input type="button" value="Use ListView" onclick="Fit.Controls.Find('DropDown').SetPicker(Fit.Controls.Find('ListView'));">
<input type="button" value="Use TreeView" onclick="Fit.Controls.Find('DropDown').SetPicker(Fit.Controls.Find('MyDropDownTree'));">
<input type="button" value="TreeView: Single Selection" onclick="Fit.Controls.Find('MyDropDownTree').Selectable(true, false);Fit.Controls.Find('MyDropDownTree').Reload();">
<input type="button" value="TreeView: Multi Selection" onclick="Fit.Controls.Find('MyDropDownTree').Selectable(true, true);Fit.Controls.Find('MyDropDownTree').Reload();">

<br><br>

<div style="font-size: 18px; font-family: 'Comic Sans MS', cursive, sans-serif; font-style: italic; font-weight: bold; color: #333333; color: orange;">
<script type="text/javascript">

var t = new Fit.Controls.WSTreeView("MyDropDownTree");
t.Width(100, "%");
t.Url("getdata.php");
t.Lines(true);
t.Selectable(true, true, true);
t.OnRequest(function(sender, eventArgs)
{
	var node = eventArgs.Node;

	if (node !== null && node.Title().indexOf("Child 2 (HasChildren)") !== -1)
		eventArgs.Request.AddData("DynamicNodeTitle", "Node title came from RequestContext");

	eventArgs.Request.AddData("NodeLevel", (node !== null ? node.GetLevel()+1 : 0).toString());
	eventArgs.Request.AddData("ParentNode", (node !== null ? node.Value() : ""));
});
t.OnItemSelectionChanging(function(sender, item) { console.log("TreeView.OnItemSelectionChanging", sender, item); /*console.trace();*/ if (item.Value === "0") { console.log("CANCELING"); return false; } });
t.OnItemSelectionChanged(function(sender, item) { console.log("TreeView.OnItemSelectionChanged", sender, item); /*console.trace();*/ });
t.OnShow(function(sender) { console.log("TreeView.OnShow", sender.GetDomElement()); });
t.OnHide(function(sender) { console.log("TreeView.OnHide", sender.GetDomElement()); });

lv = new Fit.Controls.ListView("ListView");
lv.AddItem("Hapsen", Math.random().toString());
lv.AddItem("Bedutten", Math.random().toString());
lv.AddItem("Skrutten", Math.random().toString());
lv.AddItem("Prutten", Math.random().toString());
lv.AddItem("Sutten", Math.random().toString());
lv.AddItem("Krudten", Math.random().toString());
lv.AddItem("Futten", Math.random().toString());
lv.AddItem("Mutten", Math.random().toString());
lv.AddItem("Lutten", Math.random().toString());
lv.AddItem("<b>Nutten</b> <span style='color:red'><3</span>", Math.random().toString());
lv.AddItem("<i>Natten</i>", Math.random().toString());
lv.AddItem("Katten", Math.random().toString());
lv.OnItemSelectionChanging(function(sender, item) { console.log("ListView.OnItemSelectionChanging", sender, item); /*console.trace();*/ /*if (item.Value === "0") { console.log("CANCELING"); return false; }*/ });
lv.OnItemSelectionChanged(function(sender, item) { console.log("ListView.OnItemSelectionChanged", sender, item); /*console.trace();*/ });
lv.OnShow(function(sender) { console.log("ListView.OnShow", sender.GetDomElement()); });
lv.OnHide(function(sender) { console.log("ListView.OnHide", sender.GetDomElement()); });

x = new Fit.Controls.DropDown("DropDown");
x.InputEnabled(true);
x.Width(40, "%");
x.DropDownMaxHeight(100);
x.SetPicker(lv);
x.OnChange(function(sender, value) { console.log("DropDown.OnChange", sender, value.toString()); });
x.OnInputChanged(function(sender, value) { console.log("DropDown.OnInputChanged", sender, value); });
x.OnPaste(function(sender, value) { console.log("DropDown.OnPaste", sender, value); sender.AddSelection(value, Math.random().toString(), (value !== "jit@flowit.dk" ? false : true)); });

/*x.AddDropDownEntry("More", Math.random());
x.AddDropDownEntry("Cool", Math.random());
x.AddDropDownEntry("Muuh", Math.random());
x.AddDropDownEntry("Zoo", Math.random());
x.AddDropDownEntry("Hapsen", Math.random());
x.AddDropDownEntry("Bedutten", Math.random());
x.AddDropDownEntry("Michael", Math.random());
x.AddDropDownEntry("Ole", Math.random());
x.AddDropDownEntry("Ilda", Math.random());
x.AddDropDownEntry("Hans", Math.random());
x.AddDropDownEntry("Jimmy", Math.random());
x.AddDropDownEntry("Lars", Math.random());
x.AddDropDownEntry("Martin", Math.random());
x.AddDropDownEntry("Kasper", Math.random());
x.AddDropDownEntry("Jan", Math.random());
x.AddDropDownEntry("John", Math.random());*/

x.Render();

</script>
</div>

<br><br><br>

<input>

<br><br><br>

<h1>WSDropDown</h1>

<br><br>

<div>
<script type="text/javascript">
	dd = new Fit.Controls.WSDropDown("CoolDrop");
	dd.InputEnabled(true);
	dd.OnInputChanged(function(sender, value)
	{
		dd.Search = value;
	});
	dd.OnRequest(function(sender, eventArgs)
	{
		if (Fit.Core.InstanceOf(eventArgs.Picker, Fit.Controls.WSListView) === true)
		{
			eventArgs.Request.AddData("Search", (dd.Search ? dd.Search : ""));
		}
		else // WSTreeView
		{
			eventArgs.Request.AddData("ParentNode", (eventArgs.Node !== null ? eventArgs.Node.Value() : ""));
		}
	});
	dd.OnResponse(function(sender, eventArgs) { console.log("OnResponse", sender, eventArgs); });
	dd.MultiSelectionMode(true);
	dd.Url("getdata.php");
	dd.Width(20, "em");
	dd.DropDownMaxWidth(150, "%");
	dd.Render();
	dd.GetDomElement().style.fontSize = "11px";
	dd.AddSelection("XYZ", "2");
	dd.AddSelection("ABC", "3");
	dd.AddSelection("Muuh", "2_2");

	dd.AutoPostBack(true);

	dd.GetDomElement().parentElement.style.display = "none";
	setTimeout(function() { dd.SetInputValue("Search stuff here.."); setTimeout(function() { dd.GetDomElement().parentElement.style.display = ""; }, 1200); }, 3000);

	for (var i = 0 ; i < 15 ; i++) document.body.appendChild(document.createElement("br"));
</script>
</div>

</form>
</body>
</html>
